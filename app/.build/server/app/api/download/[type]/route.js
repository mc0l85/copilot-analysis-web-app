"use strict";(()=>{var e={};e.id=924,e.ids=[924],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},629:e=>{e.exports=require("fs/promises")},5315:e=>{e.exports=require("path")},6836:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>g,patchFetch:()=>w,requestAsyncStorage:()=>f,routeModule:()=>h,serverHooks:()=>y,staticGenerationAsyncStorage:()=>M});var a={};o.r(a),o.d(a,{GET:()=>u});var r=o(9182),n=o(2007),i=o(6719),s=o(3442),l=o(629),d=o(1440),c=o(5315),p=o.n(c);async function m(){try{let e=p().join(process.cwd(),"temp"),t=await (0,l.readdir)(e),o=null,a=0;for(let r of t){let t=p().join(e,r),n=await (0,l.stat)(t);if(n.isDirectory()&&n.mtime.getTime()>a){let e=p().join(t,"output");try{let r=await (0,l.readdir)(e),i=r.some(e=>e.endsWith(".xlsx")),s=r.some(e=>e.endsWith(".html"));i&&s&&(a=n.mtime.getTime(),o=t)}catch(e){continue}}}if(o){let e=p().join(o,"output"),t=await (0,l.readdir)(e),a=t.find(e=>e.endsWith(".xlsx")),r=t.find(e=>e.endsWith(".html"));if(a&&r)return{files:{excel:p().join(e,a),html:p().join(e,r)}}}return null}catch(e){return console.error("Error finding recent analysis:",e),null}}async function u(e,{params:t}){try{let o,a,r,n;let{type:i}=t,c=new URL(e.url).searchParams.get("sessionId");if(c)o=d.t.get(c);else{let e=Array.from(d.t.values());o=e[e.length-1]}if(!o&&(console.log("No results in memory, searching file system..."),!(o=await m())))return s.NextResponse.json({error:"No analysis results found"},{status:404});if("excel"===i)a=o.files.excel,r="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",n="copilot_analysis.xlsx";else if("html"===i)a=o.files.html,r="text/html",n="leaderboard.html";else{if("leaderboard"!==i)return s.NextResponse.json({error:"Invalid download type"},{status:400});a=o.files.html,r="text/html",n="leaderboard.html"}try{let e=await (0,l.readFile)(a),t={"Content-Type":r};return"leaderboard"!==i&&(t["Content-Disposition"]=`attachment; filename="${n}"`),new s.NextResponse(e,{headers:t})}catch(e){return console.error("File read error:",e),s.NextResponse.json({error:"File not found or could not be read"},{status:404})}}catch(e){return console.error("Download error:",e),s.NextResponse.json({error:"Download failed"},{status:500})}}let h=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/download/[type]/route",pathname:"/api/download/[type]",filename:"route",bundlePath:"app/api/download/[type]/route"},resolvedPagePath:"/home/ubuntu/copilot_web_app/app/app/api/download/[type]/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:f,staticGenerationAsyncStorage:M,serverHooks:y}=h,g="/api/download/[type]/route";function w(){return(0,i.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:M})}},1440:(e,t,o)=>{o.d(t,{createTestResults:()=>r,t:()=>a});let a=new Map;function r(){let e="test-session-123",t=[];for(let e=1;e<=45;e++)t.push({email:`user${e}@company.com`,classification:"Top Utilizer",engagementScore:2.5+.5*Math.random(),consistencyPercent:75+25*Math.random(),complexityScore:8+4*Math.random(),avgToolsPerReport:3+2*Math.random(),trend:["Increasing","Stable"][Math.floor(2*Math.random())],appearances:8+Math.floor(4*Math.random()),firstAppearance:new Date(2024,Math.floor(6*Math.random()),1).toISOString(),lastActivity:new Date(2024,6,Math.floor(9*Math.random())+1).toISOString(),justification:"High Engagement",toolsUsed:["Copilot Chat","Code Completion","Documentation","Debug Assistant"],reportDates:Array.from({length:8+Math.floor(4*Math.random())},(e,t)=>new Date(2024,t,1).toISOString()),monthlyActivity:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(e=>({month:e,toolsUsed:3+3*Math.random(),complexity:6+4*Math.random()})),riskLevel:"Low"});for(let e=1;e<=70;e++)t.push({email:`under${e}@company.com`,classification:"Under-Utilized",engagementScore:1+1*Math.random(),consistencyPercent:25+35*Math.random(),complexityScore:2+4*Math.random(),avgToolsPerReport:1+2*Math.random(),trend:["Decreasing","Stable"][Math.floor(2*Math.random())],appearances:2+Math.floor(4*Math.random()),firstAppearance:new Date(2024,Math.floor(6*Math.random()),1).toISOString(),lastActivity:new Date(2024,4,Math.floor(15*Math.random())+1).toISOString(),justification:"Low consistency (active in 3 of 12 months); Downward usage trend",toolsUsed:["Copilot Chat","Code Completion"],reportDates:Array.from({length:2+Math.floor(4*Math.random())},(e,t)=>new Date(2024,t,1).toISOString()),monthlyActivity:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(e=>({month:e,toolsUsed:2*Math.random(),complexity:3*Math.random()})),riskLevel:"Medium"});for(let e=1;e<=35;e++)t.push({email:`realloc${e}@company.com`,classification:"For Reallocation",engagementScore:.8*Math.random(),consistencyPercent:25*Math.random(),complexityScore:2*Math.random(),avgToolsPerReport:1*Math.random(),trend:["Decreasing","N/A"][Math.floor(2*Math.random())],appearances:1+Math.floor(2*Math.random()),firstAppearance:new Date(2024,Math.floor(6*Math.random()),1).toISOString(),lastActivity:new Date(2024,1,Math.floor(15*Math.random())+1).toISOString(),justification:"No activity in 90+ days; No tool usage recorded",toolsUsed:[],reportDates:Array.from({length:1+Math.floor(2*Math.random())},(e,t)=>new Date(2024,t,1).toISOString()),monthlyActivity:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(e=>({month:e,toolsUsed:0,complexity:0})),riskLevel:"High"});let o={status:"success",summary:{total_users:150,top_utilizers:45,under_utilized:70,for_reallocation:35},files:{excel:"/home/ubuntu/copilot_web_app/app/temp/d49ca207-77b4-40da-9b3c-4cbaaadf6183/output/09-July-2025_Copilot_License_Evaluation.xlsx",html:"/home/ubuntu/copilot_web_app/app/temp/d49ca207-77b4-40da-9b3c-4cbaaadf6183/output/leaderboard.html"},sessionId:e,tempDir:"/home/ubuntu/copilot_web_app/app/temp/d49ca207-77b4-40da-9b3c-4cbaaadf6183",filePaths:[],detailed_users:t};return a.set(e,o),o}}};var t=require("../../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),a=t.X(0,[372,609],()=>o(6836));module.exports=a})();