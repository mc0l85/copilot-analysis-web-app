(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{69563:function(e,s,a){Promise.resolve().then(a.bind(a,54301))},54301:function(e,s,a){"use strict";a.d(s,{CopilotAnalysisApp:function(){return eE}});var t=a(57437),l=a(2265),r=a(94508);let i=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));i.displayName="Card";let n=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",e),...s}));n.displayName="CardHeader";let c=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)("h3",{ref:a,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));c.displayName="CardTitle";let d=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)("p",{ref:a,className:(0,r.cn)("text-sm text-muted-foreground",e),...s}));d.displayName="CardDescription";let o=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("p-6 pt-0",e),...s}));o.displayName="CardContent",l.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter";var m=a(41312);let x=m.fC,u=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)(m.aV,{ref:a,className:(0,r.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));u.displayName=m.aV.displayName;let h=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)(m.xz,{ref:a,className:(0,r.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));h.displayName=m.xz.displayName;let f=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)(m.VY,{ref:a,className:(0,r.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));f.displayName=m.VY.displayName;var p=a(37053),j=a(90535);let g=(0,j.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),N=l.forwardRef(({className:e,variant:s,size:a,asChild:l=!1,...i},n)=>{let c=l?p.g7:"button";return(0,t.jsx)(c,{className:(0,r.cn)(g({variant:s,size:a,className:e})),ref:n,...i})});N.displayName="Button";let v=(0,j.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function y({className:e,variant:s,...a}){return(0,t.jsx)("div",{className:(0,r.cn)(v({variant:s}),e),...a})}var b=a(17689),w=a(61649),C=a(32489);function k({label:e,accept:s,multiple:a,onUpload:n,uploadedFiles:c,description:d}){let[m,x]=(0,l.useState)(!1),u=(0,l.useCallback)(e=>{e.preventDefault(),x(!0)},[]),h=(0,l.useCallback)(e=>{e.preventDefault(),x(!1)},[]),f=(0,l.useCallback)(e=>{e.preventDefault(),x(!1);let t=Array.from(e.dataTransfer.files).filter(e=>s.split(",").map(e=>e.trim()).some(s=>s.startsWith(".")?e.name.toLowerCase().endsWith(s.toLowerCase()):e.type.match(s)));t.length>0&&n(a?t:[t[0]])},[s,a,n]),p=(0,l.useCallback)(e=>{let s=Array.from(e.target.files||[]);s.length>0&&n(a?s:[s[0]])},[a,n]),j=(0,l.useCallback)(e=>{n(c.filter((s,a)=>a!==e))},[c,n]);return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:e}),c.length>0&&(0,t.jsxs)(y,{variant:"secondary",children:[c.length," file",c.length>1?"s":""]})]}),(0,t.jsx)(i,{className:(0,r.cn)("border-2 border-dashed transition-colors cursor-pointer",m?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary/50"),onDragOver:u,onDragLeave:h,onDrop:f,children:(0,t.jsx)(o,{className:"p-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(b.Z,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Drag & drop files here or click to browse"}),(0,t.jsx)("input",{type:"file",accept:s,multiple:a,onChange:p,className:"hidden",id:`file-upload-${e}`}),(0,t.jsx)(N,{variant:"outline",size:"sm",onClick:()=>document.getElementById(`file-upload-${e}`)?.click(),children:"Select Files"}),d&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:d})]})})}),c.length>0&&(0,t.jsx)("div",{className:"space-y-2",children:c.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-muted rounded-lg",children:[(0,t.jsx)(w.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsx)("span",{className:"text-sm flex-1 truncate",children:e.name}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:[(e.size/1024/1024).toFixed(1)," MB"]}),(0,t.jsx)(N,{variant:"ghost",size:"sm",onClick:()=>j(s),className:"h-6 w-6 p-0",children:(0,t.jsx)(C.Z,{className:"h-3 w-3"})})]},s))})]})}var S=a(89699),F=a(30401);let A=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)(S.fC,{ref:a,className:(0,r.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...s,children:(0,t.jsx)(S.z$,{className:(0,r.cn)("flex items-center justify-center text-current"),children:(0,t.jsx)(F.Z,{className:"h-4 w-4"})})}));A.displayName=S.fC.displayName;var U=a(90314);let T=l.forwardRef(({className:e,children:s,...a},l)=>(0,t.jsxs)(U.fC,{ref:l,className:(0,r.cn)("relative overflow-hidden",e),...a,children:[(0,t.jsx)(U.l_,{className:"h-full w-full rounded-[inherit]",children:s}),(0,t.jsx)(z,{}),(0,t.jsx)(U.Ns,{})]}));T.displayName=U.fC.displayName;let z=l.forwardRef(({className:e,orientation:s="vertical",...a},l)=>(0,t.jsx)(U.gb,{ref:l,orientation:s,className:(0,r.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...a,children:(0,t.jsx)(U.q4,{className:"relative flex-1 rounded-full bg-border"})}));z.displayName=U.gb.displayName;var D=a(962);let R=D.fC,Z=D.wy,E=D.Fw;var O=a(40875),I=a(10407),_=a(95805),$=a(60044),L=a(83774),M=a(92369);function K({title:e,icon:s,options:a,selected:r,onSelectionChange:i}){let[n,c]=(0,l.useState)(!1);if(0===a.length)return null;let d=e=>{i(r.includes(e)?r.filter(s=>s!==e):[...r,e])};return(0,t.jsxs)(R,{open:n,onOpenChange:c,children:[(0,t.jsx)(Z,{asChild:!0,children:(0,t.jsxs)(N,{variant:"ghost",className:"w-full justify-between p-3 h-auto",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[s,(0,t.jsx)("span",{className:"font-medium",children:e}),r.length>0&&(0,t.jsx)(y,{variant:"secondary",className:"ml-2",children:r.length})]}),n?(0,t.jsx)(O.Z,{className:"h-4 w-4"}):(0,t.jsx)(I.Z,{className:"h-4 w-4"})]})}),(0,t.jsx)(E,{className:"space-y-2",children:(0,t.jsxs)("div",{className:"px-3 pb-2",children:[(0,t.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,t.jsx)(N,{variant:"outline",size:"sm",onClick:()=>{i(a)},disabled:r.length===a.length,children:"Select All"}),(0,t.jsx)(N,{variant:"outline",size:"sm",onClick:()=>{i([])},disabled:0===r.length,children:"Clear"})]}),(0,t.jsx)(T,{className:"h-32 border rounded-md p-2",children:(0,t.jsx)("div",{className:"space-y-2",children:a.map(s=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(A,{id:`${e}-${s}`,checked:r.includes(s),onCheckedChange:()=>d(s)}),(0,t.jsx)("label",{htmlFor:`${e}-${s}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:s})]},s))})})]})})]})}function P({filterOptions:e,filters:s,onFilterChange:a}){if(!Object.values(e).some(e=>e.length>0))return(0,t.jsx)(i,{children:(0,t.jsx)(o,{className:"p-4",children:(0,t.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,t.jsx)(_.Z,{className:"h-8 w-8 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm",children:"Upload target users file to enable filtering options"})]})})});let l=Object.values(s).reduce((e,s)=>e+s.length,0);return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Filter Options"}),l>0&&(0,t.jsxs)(N,{variant:"outline",size:"sm",onClick:()=>{a("companies",[]),a("departments",[]),a("locations",[]),a("managers",[])},className:"h-7",children:["Clear All (",l,")"]})]}),(0,t.jsx)(i,{children:(0,t.jsx)(o,{className:"p-0",children:(0,t.jsxs)("div",{className:"divide-y",children:[(0,t.jsx)(K,{title:"Companies",icon:(0,t.jsx)($.Z,{className:"h-4 w-4"}),options:e.companies,selected:s.companies,onSelectionChange:e=>a("companies",e)}),(0,t.jsx)(K,{title:"Departments",icon:(0,t.jsx)(_.Z,{className:"h-4 w-4"}),options:e.departments,selected:s.departments,onSelectionChange:e=>a("departments",e)}),(0,t.jsx)(K,{title:"Locations",icon:(0,t.jsx)(L.Z,{className:"h-4 w-4"}),options:e.locations,selected:s.locations,onSelectionChange:e=>a("locations",e)}),(0,t.jsx)(K,{title:"Managers",icon:(0,t.jsx)(M.Z,{className:"h-4 w-4"}),options:e.managers,selected:s.managers,onSelectionChange:e=>a("managers",e)})]})})})]})}var V=a(60610);let B=l.forwardRef(({className:e,value:s,...a},l)=>(0,t.jsx)(V.fC,{ref:l,className:(0,r.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...a,children:(0,t.jsx)(V.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));B.displayName=V.fC.displayName;var q=a(70525),J=a(3085),W=a(49474),Y=a(92735);function H({end:e,duration:s=1e3,className:a=""}){let[r,i]=(0,l.useState)(0);return(0,l.useEffect)(()=>{let a,t;let l=r=>{a||(a=r);let n=Math.min((r-a)/s,1);i(Math.floor(n*e)),n<1&&(t=requestAnimationFrame(l))};return t=requestAnimationFrame(l),()=>{t&&cancelAnimationFrame(t)}},[e,s]),(0,t.jsx)("span",{className:a,children:r.toLocaleString()})}function G({results:e,sessionId:s}){let{summary:a}=e,l=a.total_users>0?a.top_utilizers/a.total_users*100:0,r=a.total_users>0?a.under_utilized/a.total_users*100:0,d=a.total_users>0?a.for_reallocation/a.total_users*100:0,m=async e=>{try{let a=`/api/download/${e}${s?`?sessionId=${s}`:""}`,t=await fetch(a);if(!t.ok)throw Error("Download failed");let l=await t.blob(),r=window.URL.createObjectURL(l),i=document.createElement("a");i.href=r,i.download="excel"===e?"copilot_analysis.xlsx":"leaderboard.html",document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(r),document.body.removeChild(i)}catch(e){console.error("Download error:",e)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsx)(i,{className:"metric-card",children:(0,t.jsx)(o,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Users"}),(0,t.jsx)("p",{className:"text-2xl font-bold count-up",children:(0,t.jsx)(H,{end:a.total_users})})]}),(0,t.jsx)(_.Z,{className:"h-8 w-8 text-primary"})]})})}),(0,t.jsx)(i,{className:"metric-card",children:(0,t.jsx)(o,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Top Utilizers"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-green-600 count-up",children:(0,t.jsx)(H,{end:a.top_utilizers})}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[l.toFixed(1),"%"]})]}),(0,t.jsx)(q.Z,{className:"h-8 w-8 text-green-600"})]})})}),(0,t.jsx)(i,{className:"metric-card",children:(0,t.jsx)(o,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Under-Utilized"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-yellow-600 count-up",children:(0,t.jsx)(H,{end:a.under_utilized})}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[r.toFixed(1),"%"]})]}),(0,t.jsx)(J.Z,{className:"h-8 w-8 text-yellow-600"})]})})}),(0,t.jsx)(i,{className:"metric-card",children:(0,t.jsx)(o,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"For Reallocation"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-red-600 count-up",children:(0,t.jsx)(H,{end:a.for_reallocation})}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[d.toFixed(1),"%"]})]}),(0,t.jsx)(J.Z,{className:"h-8 w-8 text-red-600"})]})})})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{children:(0,t.jsxs)(c,{className:"flex items-center gap-2",children:[(0,t.jsx)(W.Z,{className:"h-5 w-5"}),"Usage Distribution"]})}),(0,t.jsxs)(o,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(y,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"Top Utilizers"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:[a.top_utilizers," users"]})]}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:[l.toFixed(1),"%"]})]}),(0,t.jsx)(B,{value:l,className:"h-2"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(y,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200",children:"Under-Utilized"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:[a.under_utilized," users"]})]}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:[r.toFixed(1),"%"]})]}),(0,t.jsx)(B,{value:r,className:"h-2"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(y,{variant:"outline",className:"bg-red-50 text-red-700 border-red-200",children:"For Reallocation"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:[a.for_reallocation," users"]})]}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:[d.toFixed(1),"%"]})]}),(0,t.jsx)(B,{value:d,className:"h-2"})]})]})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{children:(0,t.jsxs)(c,{className:"flex items-center gap-2",children:[(0,t.jsx)(Y.Z,{className:"h-5 w-5"}),"Download Reports"]})}),(0,t.jsx)(o,{children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsxs)(N,{onClick:()=>m("excel"),className:"flex-1",variant:"outline",children:[(0,t.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),"Download Excel Report"]}),(0,t.jsxs)(N,{onClick:()=>m("html"),className:"flex-1",variant:"outline",children:[(0,t.jsx)(W.Z,{className:"h-4 w-4 mr-2"}),"Download HTML Leaderboard"]})]})})]})]})}var X=a(48736),Q=a(96215),ee=a(51817);let es=[{id:1,label:"Loading data files",icon:X.Z},{id:2,label:"Applying filters",icon:Q.Z},{id:3,label:"Analyzing user patterns",icon:Q.Z},{id:4,label:"Generating reports",icon:X.Z},{id:5,label:"Creating leaderboard",icon:W.Z}];function ea(){let[e,s]=(0,l.useState)(0),[a,r]=(0,l.useState)(0);return(0,l.useEffect)(()=>{let e=setInterval(()=>{r(e=>e>=100?100:e+15*Math.random())},800);return()=>clearInterval(e)},[]),(0,l.useEffect)(()=>{let e=setInterval(()=>{s(e=>e>=es.length-1?es.length-1:e+1)},2e3);return()=>clearInterval(e)},[]),(0,t.jsx)("div",{className:"text-center py-12",children:(0,t.jsxs)("div",{className:"max-w-md mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(ee.Z,{className:"h-12 w-12 animate-spin mx-auto text-primary"}),(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Processing Your Data"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Please wait while we analyze your Copilot usage data"})]}),(0,t.jsx)(i,{children:(0,t.jsx)(o,{className:"p-4",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"Overall Progress"}),(0,t.jsxs)("span",{children:[Math.round(a),"%"]})]}),(0,t.jsx)(B,{value:a,className:"h-2"})]}),(0,t.jsx)("div",{className:"space-y-3",children:es.map((s,a)=>{let l=s.icon,r=a===e,i=a<e;return(0,t.jsxs)("div",{className:`flex items-center gap-3 p-2 rounded-lg transition-colors ${r?"bg-primary/10 text-primary":i?"bg-muted text-muted-foreground":"text-muted-foreground"}`,children:[(0,t.jsx)(l,{className:`h-4 w-4 ${r?"animate-pulse":""}`}),(0,t.jsx)("span",{className:"text-sm",children:s.label}),i&&(0,t.jsx)("div",{className:"ml-auto",children:(0,t.jsx)("div",{className:"h-2 w-2 rounded-full bg-green-500"})}),r&&(0,t.jsx)("div",{className:"ml-auto",children:(0,t.jsx)(ee.Z,{className:"h-3 w-3 animate-spin"})})]},s.id)})})]})})})]})})}let et=l.forwardRef(({className:e,type:s,...a},l)=>(0,t.jsx)("input",{type:s,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:l,...a}));et.displayName="Input";var el=a(41671),er=a(76865),ei=a(99388),en=a(21047),ec=a(82431),ed=a(73247),eo=a(40370),em=a(81596),ex=a(35153),eu=a(47625),eh=a(75169),ef=a(3574),ep=a(20407),ej=a(8147),eg=a(77031),eN=a(56940),ev=a(97059),ey=a(62994),eb=a(31699),ew=a(5481),eC=a(23263),ek=a(21156),eS=a(54061);let eF=["#60B5FF","#FF9149","#FF9898","#FF90BB","#FF6363","#80D8C3","#A19AD3","#72BF78"];function eA(e){switch(e){case"Top Utilizer":return"bg-green-100 text-green-800";case"Under-Utilized":return"bg-yellow-100 text-yellow-800";case"For Reallocation":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}function eU(e){switch(e){case"Low":return(0,t.jsx)(el.Z,{className:"h-4 w-4 text-green-600"});case"Medium":return(0,t.jsx)(er.Z,{className:"h-4 w-4 text-yellow-600"});case"High":return(0,t.jsx)(ei.Z,{className:"h-4 w-4 text-red-600"});default:return(0,t.jsx)(er.Z,{className:"h-4 w-4 text-gray-600"})}}function eT(e){switch(e){case"Increasing":return(0,t.jsx)(q.Z,{className:"h-4 w-4 text-green-600"});case"Decreasing":return(0,t.jsx)(J.Z,{className:"h-4 w-4 text-red-600"});case"Stable":return(0,t.jsx)(en.Z,{className:"h-4 w-4 text-yellow-600"});default:return(0,t.jsx)(en.Z,{className:"h-4 w-4 text-gray-600"})}}function ez({sessionId:e}){let[s,a]=(0,l.useState)([]),[r,m]=(0,l.useState)([]),[p,j]=(0,l.useState)(new Set),[g,v]=(0,l.useState)(""),[b,w]=(0,l.useState)("all"),[C,k]=(0,l.useState)(!1),[S,F]=(0,l.useState)(null),[U,z]=(0,l.useState)(null),[D,R]=(0,l.useState)("overview"),[Z,E]=(0,l.useState)(!1),{toast:O}=(0,ex.pm)(),I=(0,l.useRef)(null),$=(0,l.useCallback)(async e=>{if(e){I.current=e,k(!0),F(null);try{let s=await fetch(`/api/deep-dive?sessionId=${e}`);if(I.current!==e)return;if(!s.ok)throw Error(`Failed to fetch user data: ${s.statusText}`);let t=await s.json();if(I.current===e){let e=t.users||[];a(e),m(e),E(!0)}}catch(s){if(I.current===e){let e=s instanceof Error?s.message:"Failed to load user data";F(e),console.error("Error fetching users:",s),O({title:"Error",description:e,variant:"destructive"})}}finally{I.current===e&&k(!1)}}},[O]);(0,l.useEffect)(()=>{e?(a([]),m([]),j(new Set),z(null),E(!1),F(null),$(e)):(a([]),m([]),j(new Set),z(null),E(!1),F(null),k(!1))},[e,$]),(0,l.useEffect)(()=>{if(Z&&s.length>0&&0===p.size){let e=s[0];j(new Set([e.email])),R("individual"),O({title:"Details pane activated",description:`Auto-selected ${e.email} to show detailed analysis. Click other users to explore more.`,duration:4e3})}},[Z,s,p.size,O]);let L=(0,l.useCallback)((e,s,a)=>{let t=e;if(s.trim()){let e=s.toLowerCase();t=t.filter(s=>s.email.toLowerCase().includes(e))}return"all"!==a&&(t=t.filter(e=>e.classification===a)),t},[]);(0,l.useEffect)(()=>{let e=setTimeout(()=>{m(L(s,g,b))},150);return()=>clearTimeout(e)},[s,g,b,L]);let M=(0,l.useCallback)((e,s)=>{if(0===e.size)return null;Array.from(e);let a=s.filter(s=>e.has(s.email));return 0===a.length?null:{averageEngagement:a.reduce((e,s)=>e+s.engagementScore,0)/a.length,averageConsistency:a.reduce((e,s)=>e+s.consistencyPercent,0)/a.length,totalToolsUsed:new Set(a.flatMap(e=>e.toolsUsed)).size,commonTools:K(a),trendAnalysis:P(a),riskDistribution:V(a),monthlyComparison:B(a)}},[]);(0,l.useEffect)(()=>{z(M(p,s))},[p,s,M]);let K=(0,l.useCallback)(e=>0===e.length?[]:Object.entries(e.reduce((e,s)=>(s.toolsUsed.forEach(s=>{e[s]=(e[s]||0)+1}),e),{})).filter(([s,a])=>a>.5*e.length).map(([e,s])=>({tool:e,count:s})),[]),P=(0,l.useCallback)(e=>Object.entries(e.reduce((e,s)=>(e[s.trend]=(e[s.trend]||0)+1,e),{})).map(([e,s])=>({trend:e,count:s})),[]),V=(0,l.useCallback)(e=>Object.entries(e.reduce((e,s)=>(e[s.riskLevel]=(e[s.riskLevel]||0)+1,e),{})).map(([e,s])=>({risk:e,count:s})),[]),B=(0,l.useCallback)(e=>["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(s=>{let a=e.map(e=>e.monthlyActivity.find(e=>e.month===s)||{month:s,toolsUsed:0,complexity:0});return{month:s,averageToolsUsed:a.reduce((e,s)=>e+s.toolsUsed,0)/e.length,averageComplexity:a.reduce((e,s)=>e+s.complexity,0)/e.length}}),[]),q=(0,l.useCallback)(e=>{j(s=>{let a=new Set(s);return a.has(e)?a.delete(e):a.add(e),1===a.size?R("individual"):a.size>1&&R("comparison"),a})},[]),J=(0,l.useCallback)(()=>{j(new Set),R("overview")},[]),W=(0,l.useCallback)(()=>{j(new Set(r.map(e=>e.email))),r.length>1?R("comparison"):1===r.length&&R("individual")},[r]),Y=(0,l.useMemo)(()=>0===s.length?[]:Object.entries(s.reduce((e,s)=>(e[s.classification]=(e[s.classification]||0)+1,e),{})).map(([e,a])=>({classification:e,count:a,percentage:a/s.length*100})),[s]),H=(0,l.useMemo)(()=>0===s.length?[]:[{range:"0-0.5",min:0,max:.5},{range:"0.5-1.0",min:.5,max:1},{range:"1.0-1.5",min:1,max:1.5},{range:"1.5-2.0",min:1.5,max:2},{range:"2.0-2.5",min:2,max:2.5},{range:"2.5+",min:2.5,max:10}].map(({range:e,min:a,max:t})=>({range:e,count:s.filter(e=>e.engagementScore>=a&&e.engagementScore<t).length})),[s]);return C?(0,t.jsxs)("div",{className:"flex items-center justify-center h-64",children:[(0,t.jsx)(ec.Z,{className:"h-8 w-8 animate-spin text-primary"}),(0,t.jsx)("span",{className:"ml-2",children:"Loading user data..."})]}):S?(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(ei.Z,{className:"h-12 w-12 mx-auto mb-4 text-destructive"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Failed to Load Data"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-4",children:S}),(0,t.jsxs)(N,{onClick:()=>e&&$(e),variant:"outline",children:[(0,t.jsx)(ec.Z,{className:"h-4 w-4 mr-2"}),"Retry"]})]})}):Z&&0!==s.length?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(i,{children:[(0,t.jsxs)(n,{children:[(0,t.jsxs)(c,{className:"flex items-center gap-2",children:[(0,t.jsx)(ed.Z,{className:"h-5 w-5"}),"User Search & Filter"]}),(0,t.jsx)(d,{children:"Search and filter users to analyze their Copilot usage patterns"})]}),(0,t.jsx)(o,{children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(et,{placeholder:"Search users by email...",value:g,onChange:e=>v(e.target.value),className:"w-full"})}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(N,{variant:"all"===b?"default":"outline",onClick:()=>w("all"),size:"sm",children:["All (",s.length,")"]}),(0,t.jsxs)(N,{variant:"Top Utilizer"===b?"default":"outline",onClick:()=>w("Top Utilizer"),size:"sm",children:["Top (",s.filter(e=>"Top Utilizer"===e.classification).length,")"]}),(0,t.jsxs)(N,{variant:"Under-Utilized"===b?"default":"outline",onClick:()=>w("Under-Utilized"),size:"sm",children:["Under (",s.filter(e=>"Under-Utilized"===e.classification).length,")"]}),(0,t.jsxs)(N,{variant:"For Reallocation"===b?"default":"outline",onClick:()=>w("For Reallocation"),size:"sm",children:["Realloc (",s.filter(e=>"For Reallocation"===e.classification).length,")"]})]})]})})]}),(0,t.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[(0,t.jsxs)(i,{className:"lg:col-span-1",children:[(0,t.jsx)(n,{children:(0,t.jsxs)(c,{className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(_.Z,{className:"h-5 w-5"}),"Users (",r.length,")"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(N,{variant:"outline",size:"sm",onClick:W,disabled:0===r.length,children:"Select All"}),(0,t.jsxs)(N,{variant:"outline",size:"sm",onClick:J,disabled:0===p.size,children:["Clear (",p.size,")"]})]})]})}),(0,t.jsx)(o,{children:(0,t.jsx)(T,{className:"h-[600px]",children:(0,t.jsx)("div",{className:"space-y-2",children:r.map(e=>(0,t.jsx)("div",{className:`p-3 rounded-lg border cursor-pointer transition-colors ${p.has(e.email)?"border-primary bg-primary/5":"border-border hover:bg-muted/50"}`,onClick:()=>q(e.email),children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(A,{checked:p.has(e.email),onChange:()=>q(e.email)}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{className:"font-medium text-sm truncate",children:e.email}),eU(e.riskLevel)]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(y,{variant:"secondary",className:`text-xs ${eA(e.classification)}`,children:e.classification}),eT(e.trend)]}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,t.jsxs)("span",{children:["Score: ",e.engagementScore.toFixed(2)]}),(0,t.jsxs)("span",{children:[e.consistencyPercent.toFixed(0),"%"]})]})]})]})},e.email))})})})]}),(0,t.jsxs)(i,{className:"lg:col-span-2",children:[(0,t.jsxs)(n,{children:[(0,t.jsxs)(c,{className:"flex items-center gap-2",children:[(0,t.jsx)(Q.Z,{className:"h-5 w-5"}),"Analysis Dashboard"]}),(0,t.jsx)(d,{children:p.size>0?`Analyzing ${p.size} selected user${p.size>1?"s":""}`:"Select users to view detailed analysis"})]}),(0,t.jsx)(o,{children:(0,t.jsxs)(x,{value:D,onValueChange:R,children:[(0,t.jsxs)(u,{className:"grid w-full grid-cols-4",children:[(0,t.jsx)(h,{value:"overview",children:"Overview"}),(0,t.jsx)(h,{value:"individual",children:"Individual"}),(0,t.jsx)(h,{value:"comparison",children:"Comparison"}),(0,t.jsx)(h,{value:"trends",children:"Trends"})]}),(0,t.jsx)(f,{value:"overview",className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Classification Distribution"})}),(0,t.jsx)(o,{children:(0,t.jsx)(eu.h,{width:"100%",height:200,children:(0,t.jsxs)(eh.u,{children:[(0,t.jsx)(ef.b,{data:Y,dataKey:"count",nameKey:"classification",cx:"50%",cy:"50%",outerRadius:80,label:({classification:e,percentage:s})=>`${e.split(" ")[0]}: ${s.toFixed(0)}%`,children:Y.map((e,s)=>(0,t.jsx)(ep.b,{fill:eF[s%eF.length]},`cell-${s}`))}),(0,t.jsx)(ej.u,{})]})})})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Engagement Score Distribution"})}),(0,t.jsx)(o,{children:(0,t.jsx)(eu.h,{width:"100%",height:200,children:(0,t.jsxs)(eg.v,{data:H,children:[(0,t.jsx)(eN.q,{strokeDasharray:"3 3"}),(0,t.jsx)(ev.K,{dataKey:"range",tick:{fontSize:10}}),(0,t.jsx)(ey.B,{tick:{fontSize:10}}),(0,t.jsx)(ej.u,{}),(0,t.jsx)(eb.$,{dataKey:"count",fill:eF[0]})]})})})]})]})}),(0,t.jsx)(f,{value:"individual",className:"space-y-4 animate-in fade-in-50 duration-300",children:0===p.size?(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,t.jsx)(_.Z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Select a User"}),(0,t.jsx)("p",{children:"Click on a user from the list to view detailed individual analysis"})]}):1===p.size?(0,t.jsx)("div",{className:"animate-in slide-in-from-right-5 duration-500",children:(0,t.jsx)(eD,{user:s.find(e=>p.has(e.email))})}):(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,t.jsx)(er.Z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Too Many Users Selected"}),(0,t.jsx)("p",{children:"Select only one user to view individual analysis"})]})}),(0,t.jsx)(f,{value:"comparison",className:"space-y-4 animate-in fade-in-50 duration-300",children:p.size<2?(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,t.jsx)(eo.Z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Select Multiple Users"}),(0,t.jsx)("p",{children:"Choose 2 or more users to compare their usage patterns and metrics"})]}):(0,t.jsx)("div",{className:"animate-in slide-in-from-left-5 duration-500",children:(0,t.jsx)(eR,{users:s.filter(e=>p.has(e.email)),comparisonData:U})})}),(0,t.jsx)(f,{value:"trends",className:"space-y-4 animate-in fade-in-50 duration-300",children:0===p.size?(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,t.jsx)(em.Z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Select Users for Trends"}),(0,t.jsx)("p",{children:"Choose one or more users to view their usage trends and patterns over time"})]}):(0,t.jsx)("div",{className:"animate-in slide-in-from-bottom-5 duration-500",children:(0,t.jsx)(eZ,{users:s.filter(e=>p.has(e.email)),comparisonData:U})})})]})})]})]})]}):(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(_.Z,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No User Data Available"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:e?"No detailed user data found for this analysis.":"Please run an analysis first to view deep dive data."})]})})}function eD({user:e}){return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)(i,{children:[(0,t.jsxs)(n,{className:"pb-3",children:[(0,t.jsx)(c,{className:"text-lg",children:e.email}),(0,t.jsx)(d,{children:(0,t.jsx)(y,{className:eA(e.classification),children:e.classification})})]}),(0,t.jsxs)(o,{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Engagement Score"}),(0,t.jsx)("span",{className:"font-medium",children:e.engagementScore.toFixed(2)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Consistency"}),(0,t.jsxs)("span",{className:"font-medium",children:[e.consistencyPercent.toFixed(1),"%"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Complexity Score"}),(0,t.jsx)("span",{className:"font-medium",children:e.complexityScore.toFixed(1)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Avg Tools/Report"}),(0,t.jsx)("span",{className:"font-medium",children:e.avgToolsPerReport.toFixed(1)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Report Appearances"}),(0,t.jsx)("span",{className:"font-medium",children:e.appearances})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Risk Level"}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[eU(e.riskLevel),e.riskLevel]})]})]})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Classification Reasoning"})}),(0,t.jsx)(o,{children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Justification:"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.justification})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Tools Used:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:e.toolsUsed.map((e,s)=>(0,t.jsx)(y,{variant:"outline",className:"text-xs",children:e},s))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"First Seen:"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(e.firstAppearance).toLocaleDateString()})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Last Activity:"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(e.lastActivity).toLocaleDateString()})]})]})})]})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Monthly Activity Trend"})}),(0,t.jsx)(o,{children:(0,t.jsx)(eu.h,{width:"100%",height:300,children:(0,t.jsxs)(ew.T,{data:e.monthlyActivity,children:[(0,t.jsx)(eN.q,{strokeDasharray:"3 3"}),(0,t.jsx)(ev.K,{dataKey:"month"}),(0,t.jsx)(ey.B,{}),(0,t.jsx)(ej.u,{}),(0,t.jsx)(eC.u,{type:"monotone",dataKey:"toolsUsed",stackId:"1",stroke:eF[0],fill:eF[0],name:"Tools Used"}),(0,t.jsx)(eC.u,{type:"monotone",dataKey:"complexity",stackId:"2",stroke:eF[1],fill:eF[1],name:"Complexity Score"})]})})})]})]})}function eR({users:e,comparisonData:s}){return s?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Average Metrics"})}),(0,t.jsxs)(o,{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Engagement"}),(0,t.jsx)("span",{className:"font-medium",children:s.averageEngagement.toFixed(2)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Consistency"}),(0,t.jsxs)("span",{className:"font-medium",children:[s.averageConsistency.toFixed(1),"%"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Total Tools"}),(0,t.jsx)("span",{className:"font-medium",children:s.totalToolsUsed})]})]})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Common Tools"})}),(0,t.jsx)(o,{children:(0,t.jsx)("div",{className:"space-y-2",children:s.commonTools.slice(0,5).map((e,s)=>(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"truncate",children:e.tool}),(0,t.jsx)("span",{className:"text-muted-foreground",children:e.count})]},s))})})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Risk Distribution"})}),(0,t.jsx)(o,{children:(0,t.jsx)(eu.h,{width:"100%",height:150,children:(0,t.jsxs)(eh.u,{children:[(0,t.jsx)(ef.b,{data:s.riskDistribution,dataKey:"count",nameKey:"risk",cx:"50%",cy:"50%",outerRadius:60,label:({risk:e,count:s})=>`${e}: ${s}`,children:s.riskDistribution.map((e,s)=>(0,t.jsx)(ep.b,{fill:eF[s%eF.length]},`cell-${s}`))}),(0,t.jsx)(ej.u,{})]})})})]})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Monthly Comparison"})}),(0,t.jsx)(o,{children:(0,t.jsx)(eu.h,{width:"100%",height:300,children:(0,t.jsxs)(ek.w,{data:s.monthlyComparison,children:[(0,t.jsx)(eN.q,{strokeDasharray:"3 3"}),(0,t.jsx)(ev.K,{dataKey:"month"}),(0,t.jsx)(ey.B,{}),(0,t.jsx)(ej.u,{}),(0,t.jsx)(eS.x,{type:"monotone",dataKey:"averageToolsUsed",stroke:eF[0],name:"Avg Tools Used"}),(0,t.jsx)(eS.x,{type:"monotone",dataKey:"averageComplexity",stroke:eF[1],name:"Avg Complexity"})]})})})]})]}):null}function eZ({users:e,comparisonData:s}){return s?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Trend Analysis"})}),(0,t.jsx)(o,{children:(0,t.jsx)(eu.h,{width:"100%",height:200,children:(0,t.jsxs)(eg.v,{data:s.trendAnalysis,children:[(0,t.jsx)(eN.q,{strokeDasharray:"3 3"}),(0,t.jsx)(ev.K,{dataKey:"trend"}),(0,t.jsx)(ey.B,{}),(0,t.jsx)(ej.u,{}),(0,t.jsx)(eb.$,{dataKey:"count",fill:eF[2]})]})})})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Selected Users"})}),(0,t.jsx)(o,{children:(0,t.jsx)("div",{className:"space-y-2",children:e.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-2 rounded border",children:[(0,t.jsx)("span",{className:"text-sm font-medium truncate",children:e.email}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(y,{className:`text-xs ${eA(e.classification)}`,children:e.classification.split(" ")[0]}),eT(e.trend)]})]},s))})})]})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Engagement Trends Over Time"})}),(0,t.jsx)(o,{children:(0,t.jsx)(eu.h,{width:"100%",height:300,children:(0,t.jsxs)(ek.w,{data:s.monthlyComparison,children:[(0,t.jsx)(eN.q,{strokeDasharray:"3 3"}),(0,t.jsx)(ev.K,{dataKey:"month"}),(0,t.jsx)(ey.B,{}),(0,t.jsx)(ej.u,{}),(0,t.jsx)(eS.x,{type:"monotone",dataKey:"averageToolsUsed",stroke:eF[0],strokeWidth:2,name:"Tools Used"}),(0,t.jsx)(eS.x,{type:"monotone",dataKey:"averageComplexity",stroke:eF[1],strokeWidth:2,name:"Complexity"})]})})})]})]}):null}function eE(){let[e,s]=(0,l.useState)("analysis"),[a,r]=(0,l.useState)({targetUsersFile:null,usageReportsFiles:[],filters:{companies:[],departments:[],locations:[],managers:[]},filterOptions:{companies:[],departments:[],locations:[],managers:[]}}),[m,p]=(0,l.useState)({isProcessing:!1,results:null,error:null,sessionId:null}),{toast:j}=(0,ex.pm)();(0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/test-results",{method:"POST"});if(e.ok){let s=await e.json();p(e=>({...e,results:s,sessionId:s.sessionId})),j({title:"Demo data loaded",description:"Sample analysis results loaded for demonstration. Upload your own files to replace with real data."})}}catch(e){console.log("No test results available, starting fresh")}})()},[j]);let g=(0,l.useCallback)(e=>{r(s=>({...s,targetUsersFile:e}));let s=new FileReader;s.onload=e=>{try{let s=(e.target?.result).split("\n"),a=s[0].split(",").map(e=>e.trim().replace(/"/g,"")),t=a.findIndex(e=>e.toLowerCase().includes("company")),l=a.findIndex(e=>e.toLowerCase().includes("department")),i=a.findIndex(e=>e.toLowerCase().includes("city")),n=a.findIndex(e=>e.toLowerCase().includes("manager")),c=new Set,d=new Set,o=new Set,m=new Set;for(let e=1;e<s.length;e++){let a=s[e].split(",").map(e=>e.trim().replace(/"/g,""));-1!==t&&a[t]&&c.add(a[t]),-1!==l&&a[l]&&d.add(a[l]),-1!==i&&a[i]&&o.add(a[i]),-1!==n&&a[n]&&a[n].split("->").forEach(e=>m.add(e.trim()))}r(e=>({...e,filterOptions:{companies:Array.from(c).filter(e=>e).sort(),departments:Array.from(d).filter(e=>e).sort(),locations:Array.from(o).filter(e=>e).sort(),managers:Array.from(m).filter(e=>e).sort()}})),j({title:"Target users file uploaded",description:"Filter options have been populated based on your data."})}catch(e){console.error("Error parsing file:",e),j({title:"Error parsing file",description:"Could not extract filter options from the target users file.",variant:"destructive"})}},s.readAsText(e)},[j]),v=(0,l.useCallback)(e=>{r(s=>({...s,usageReportsFiles:e})),j({title:"Usage reports uploaded",description:`${e.length} file(s) uploaded successfully.`})},[j]),y=(0,l.useCallback)((e,s)=>{r(a=>({...a,filters:{...a.filters,[e]:s}}))},[]),b=(0,l.useCallback)(async()=>{if(0===a.usageReportsFiles.length){j({title:"Missing files",description:"Please upload at least one usage report file.",variant:"destructive"});return}p(e=>({...e,isProcessing:!0,error:null}));try{let e=new FormData;a.targetUsersFile&&e.append("targetUsersFile",a.targetUsersFile),a.usageReportsFiles.forEach((s,a)=>{e.append(`usageReportFile_${a}`,s)}),e.append("filters",JSON.stringify(a.filters));let s=await fetch("/api/analyze",{method:"POST",body:e});if(!s.ok)throw Error(`Analysis failed: ${s.statusText}`);let t=await s.json();if("error"===t.status)throw Error(t.message);p(e=>({...e,isProcessing:!1,results:t,error:null,sessionId:t.sessionId})),j({title:"Analysis completed",description:"Your Copilot usage analysis has been generated successfully."})}catch(e){p(s=>({...s,isProcessing:!1,error:e instanceof Error?e.message:"An unexpected error occurred"})),j({title:"Analysis failed",description:e instanceof Error?e.message:"An unexpected error occurred",variant:"destructive"})}},[a,j]),C=a.usageReportsFiles.length>0&&!m.isProcessing;return(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold text-foreground mb-2",children:"Copilot Usage Analysis"}),(0,t.jsx)("p",{className:"text-xl text-muted-foreground",children:"Analyze Microsoft Copilot adoption patterns and user engagement"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-12 gap-6",children:[(0,t.jsxs)("div",{className:`space-y-6 ${m.results?"xl:col-span-3":"xl:col-span-4"}`,children:[(0,t.jsxs)(i,{children:[(0,t.jsxs)(n,{children:[(0,t.jsxs)(c,{className:"flex items-center gap-2",children:[(0,t.jsx)(w.Z,{className:"h-5 w-5"}),"1. Upload Data"]}),(0,t.jsx)(d,{children:"Upload your target users and usage report files"})]}),(0,t.jsxs)(o,{className:"space-y-4",children:[(0,t.jsx)(k,{label:"Target Users File (Optional)",accept:".csv,.xlsx,.xls",multiple:!1,onUpload:e=>g(e[0]),uploadedFiles:a.targetUsersFile?[a.targetUsersFile]:[],description:"CSV or Excel file containing user information"}),(0,t.jsx)(k,{label:"Usage Reports (Required)",accept:".csv,.xlsx,.xls",multiple:!0,onUpload:v,uploadedFiles:a.usageReportsFiles,description:"One or more CSV or Excel files with usage data"})]})]}),(0,t.jsxs)(i,{children:[(0,t.jsxs)(n,{children:[(0,t.jsxs)(c,{className:"flex items-center gap-2",children:[(0,t.jsx)(_.Z,{className:"h-5 w-5"}),"2. Apply Filters (Optional)"]}),(0,t.jsx)(d,{children:"Filter users by company, department, location, or manager"})]}),(0,t.jsx)(o,{children:(0,t.jsx)(P,{filterOptions:a.filterOptions,filters:a.filters,onFilterChange:y})})]}),(0,t.jsx)(i,{children:(0,t.jsx)(o,{className:"pt-6",children:(0,t.jsxs)(N,{onClick:b,disabled:!C,className:"w-full",size:"lg",children:[(0,t.jsx)(Q.Z,{className:"h-5 w-5 mr-2"}),m.isProcessing?"Analyzing...":"Analyze Data"]})})})]}),(0,t.jsx)("div",{className:`${m.results?"xl:col-span-9":"xl:col-span-8"}`,children:(0,t.jsx)(i,{className:"h-full min-h-[600px]",children:(0,t.jsxs)(o,{className:"p-6 h-full",children:[m.isProcessing&&(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsx)(ea,{})}),m.error&&(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsxs)("div",{className:"text-destructive mb-4",children:[(0,t.jsx)(q.Z,{className:"h-12 w-12 mx-auto mb-2"}),(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Analysis Failed"})]}),(0,t.jsx)("p",{className:"text-muted-foreground",children:m.error})]})}),!m.isProcessing&&!m.error&&!m.results&&(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsxs)("div",{className:"text-muted-foreground mb-4",children:[(0,t.jsx)(W.Z,{className:"h-12 w-12 mx-auto mb-2"}),(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Ready to Analyze"})]}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Your analysis results will appear here after processing"})]})}),m.results&&(0,t.jsx)("div",{className:"h-full flex flex-col",children:(0,t.jsxs)(x,{value:e,onValueChange:s,className:"flex-1 flex flex-col",children:[(0,t.jsxs)(u,{className:"grid w-full grid-cols-3 mb-6",children:[(0,t.jsx)(h,{value:"analysis",children:"Analysis"}),(0,t.jsx)(h,{value:"leaderboard",children:"Leaderboard"}),(0,t.jsx)(h,{value:"deep-dive",children:"Deep Dive"})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-auto",children:[(0,t.jsx)(f,{value:"analysis",className:"mt-0 h-full",children:(0,t.jsx)(G,{results:m.results,sessionId:m.sessionId})}),(0,t.jsx)(f,{value:"leaderboard",className:"mt-0 h-full",children:(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(W.Z,{className:"h-12 w-12 mx-auto mb-4 text-primary"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Leaderboard"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-4",children:"View top performing users in the interactive leaderboard"}),(0,t.jsx)(N,{onClick:()=>window.open(`/api/download/leaderboard?sessionId=${m.sessionId}`,"_blank"),variant:"outline",children:"Open Leaderboard"})]})})}),(0,t.jsx)(f,{value:"deep-dive",className:"mt-0 h-full",children:(0,t.jsx)(ez,{sessionId:m.sessionId})})]})]})})]})})})]})]})}},35153:function(e,s,a){"use strict";a.d(s,{pm:function(){return x}});var t=a(2265);let l=0,r=new Map,i=e=>{if(r.has(e))return;let s=setTimeout(()=>{r.delete(e),o({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,s)},n=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=s;return a?i(a):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},c=[],d={toasts:[]};function o(e){d=n(d,e),c.forEach(e=>{e(d)})}function m({...e}){let s=(l=(l+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>o({type:"DISMISS_TOAST",toastId:s});return o({type:"ADD_TOAST",toast:{...e,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>o({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function x(){let[e,s]=t.useState(d);return t.useEffect(()=>(c.push(s),()=>{let e=c.indexOf(s);e>-1&&c.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>o({type:"DISMISS_TOAST",toastId:e})}}},94508:function(e,s,a){"use strict";a.d(s,{cn:function(){return r}});var t=a(61994),l=a(53335);function r(...e){return(0,l.m6)((0,t.W)(e))}}},function(e){e.O(0,[521,841,971,117,744],function(){return e(e.s=69563)}),_N_E=e.O()}]);