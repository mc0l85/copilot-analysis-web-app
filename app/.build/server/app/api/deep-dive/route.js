"use strict";(()=>{var e={};e.id=750,e.ids=[750],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7655:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>g,patchFetch:()=>f,requestAsyncStorage:()=>p,routeModule:()=>u,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m});var a={};o.r(a),o.d(a,{GET:()=>d,POST:()=>c});var r=o(9182),s=o(2007),n=o(6719),i=o(3442),l=o(1440);async function d(e){try{let{searchParams:t}=new URL(e.url),a=t.get("sessionId");if(console.log("Deep dive API called with sessionId:",a),!a)return console.log("No sessionId provided"),i.NextResponse.json({error:"Session ID is required"},{status:400});let r=l.t.get(a);if(console.log("Results found:",!!r),!r){if(console.log("Session not found in analysisResults"),console.log("Available sessions:",Array.from(l.t.keys())),"test-session-123"===a){console.log("Creating test results for test session");let{createTestResults:e}=await Promise.resolve().then(o.bind(o,1440));r=e()}if(!r)return i.NextResponse.json({error:"Session not found"},{status:404})}if(!r.detailed_users||0===r.detailed_users.length)return console.log("No detailed user data available"),i.NextResponse.json({error:"No detailed user data available"},{status:404});let s=r.detailed_users;return console.log("Returning",s.length,"users"),i.NextResponse.json({status:"success",users:s,summary:r.summary})}catch(e){return console.error("Deep dive API error:",e),i.NextResponse.json({error:"Failed to fetch deep dive data"},{status:500})}}async function c(e){try{let{searchParams:t}=new URL(e.url),o=t.get("sessionId"),{selectedUsers:a}=await e.json();if(!o)return i.NextResponse.json({error:"Session ID is required"},{status:400});let r=l.t.get(o);if(!r)return i.NextResponse.json({error:"Session not found"},{status:404});if(!r.detailed_users||0===r.detailed_users.length)return i.NextResponse.json({error:"No detailed user data available"},{status:404});let s=function(e,t){if(0===e.length)return{averageEngagement:0,totalToolsUsed:0,commonTools:[],trendAnalysis:{increasing:0,stable:0,decreasing:0},riskDistribution:{low:0,medium:0,high:0}};let o=t.filter(t=>e.includes(t.email)),a=o.length>0?o.reduce((e,t)=>e+(t.engagementScore||0),0)/o.length:0,r=new Set;o.forEach(e=>{e.toolsUsed&&Array.isArray(e.toolsUsed)&&e.toolsUsed.forEach(e=>r.add(e))});let s={};o.forEach(e=>{e.toolsUsed&&Array.isArray(e.toolsUsed)&&e.toolsUsed.forEach(e=>{s[e]=(s[e]||0)+1})});let n=Object.keys(s).filter(e=>s[e]>=Math.max(1,Math.floor(.5*o.length))),i={increasing:0,stable:0,decreasing:0};o.forEach(e=>{let t=(e.trend||"N/A").toLowerCase();"increasing"===t?i.increasing++:"stable"===t?i.stable++:"decreasing"===t&&i.decreasing++});let l={low:0,medium:0,high:0};return o.forEach(e=>{let t=(e.riskLevel||"low").toLowerCase();"low"===t?l.low++:"medium"===t?l.medium++:"high"===t&&l.high++}),{averageEngagement:Math.round(100*a)/100,totalToolsUsed:r.size,commonTools:n,trendAnalysis:i,riskDistribution:l}}(a,r.detailed_users);return i.NextResponse.json({status:"success",comparison:s})}catch(e){return console.error("Deep dive comparison API error:",e),i.NextResponse.json({error:"Failed to generate comparison data"},{status:500})}}let u=new r.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/deep-dive/route",pathname:"/api/deep-dive",filename:"route",bundlePath:"app/api/deep-dive/route"},resolvedPagePath:"/home/ubuntu/copilot_web_app/app/app/api/deep-dive/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:p,staticGenerationAsyncStorage:m,serverHooks:h}=u,g="/api/deep-dive/route";function f(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}},1440:(e,t,o)=>{o.d(t,{createTestResults:()=>r,t:()=>a});let a=new Map;function r(){let e="test-session-123",t=[];for(let e=1;e<=45;e++)t.push({email:`user${e}@company.com`,classification:"Top Utilizer",engagementScore:2.5+.5*Math.random(),consistencyPercent:75+25*Math.random(),complexityScore:8+4*Math.random(),avgToolsPerReport:3+2*Math.random(),trend:["Increasing","Stable"][Math.floor(2*Math.random())],appearances:8+Math.floor(4*Math.random()),firstAppearance:new Date(2024,Math.floor(6*Math.random()),1).toISOString(),lastActivity:new Date(2024,6,Math.floor(9*Math.random())+1).toISOString(),justification:"High Engagement",toolsUsed:["Copilot Chat","Code Completion","Documentation","Debug Assistant"],reportDates:Array.from({length:8+Math.floor(4*Math.random())},(e,t)=>new Date(2024,t,1).toISOString()),monthlyActivity:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(e=>({month:e,toolsUsed:3+3*Math.random(),complexity:6+4*Math.random()})),riskLevel:"Low"});for(let e=1;e<=70;e++)t.push({email:`under${e}@company.com`,classification:"Under-Utilized",engagementScore:1+1*Math.random(),consistencyPercent:25+35*Math.random(),complexityScore:2+4*Math.random(),avgToolsPerReport:1+2*Math.random(),trend:["Decreasing","Stable"][Math.floor(2*Math.random())],appearances:2+Math.floor(4*Math.random()),firstAppearance:new Date(2024,Math.floor(6*Math.random()),1).toISOString(),lastActivity:new Date(2024,4,Math.floor(15*Math.random())+1).toISOString(),justification:"Low consistency (active in 3 of 12 months); Downward usage trend",toolsUsed:["Copilot Chat","Code Completion"],reportDates:Array.from({length:2+Math.floor(4*Math.random())},(e,t)=>new Date(2024,t,1).toISOString()),monthlyActivity:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(e=>({month:e,toolsUsed:2*Math.random(),complexity:3*Math.random()})),riskLevel:"Medium"});for(let e=1;e<=35;e++)t.push({email:`realloc${e}@company.com`,classification:"For Reallocation",engagementScore:.8*Math.random(),consistencyPercent:25*Math.random(),complexityScore:2*Math.random(),avgToolsPerReport:1*Math.random(),trend:["Decreasing","N/A"][Math.floor(2*Math.random())],appearances:1+Math.floor(2*Math.random()),firstAppearance:new Date(2024,Math.floor(6*Math.random()),1).toISOString(),lastActivity:new Date(2024,1,Math.floor(15*Math.random())+1).toISOString(),justification:"No activity in 90+ days; No tool usage recorded",toolsUsed:[],reportDates:Array.from({length:1+Math.floor(2*Math.random())},(e,t)=>new Date(2024,t,1).toISOString()),monthlyActivity:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(e=>({month:e,toolsUsed:0,complexity:0})),riskLevel:"High"});let o={status:"success",summary:{total_users:150,top_utilizers:45,under_utilized:70,for_reallocation:35},files:{excel:"/home/ubuntu/copilot_web_app/app/temp/d49ca207-77b4-40da-9b3c-4cbaaadf6183/output/09-July-2025_Copilot_License_Evaluation.xlsx",html:"/home/ubuntu/copilot_web_app/app/temp/d49ca207-77b4-40da-9b3c-4cbaaadf6183/output/leaderboard.html"},sessionId:e,tempDir:"/home/ubuntu/copilot_web_app/app/temp/d49ca207-77b4-40da-9b3c-4cbaaadf6183",filePaths:[],detailed_users:t};return a.set(e,o),o}}};var t=require("../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),a=t.X(0,[372,609],()=>o(7655));module.exports=a})();