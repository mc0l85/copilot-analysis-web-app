(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{93636:function(e,s,a){Promise.resolve().then(a.bind(a,24567))},24567:function(e,s,a){"use strict";a.d(s,{CopilotAnalysisApp:function(){return eD}});var t=a(15444),l=a(89300),r=a(65522);let i=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));i.displayName="Card";let n=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",e),...s}));n.displayName="CardHeader";let c=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)("h3",{ref:a,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));c.displayName="CardTitle";let d=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)("p",{ref:a,className:(0,r.cn)("text-sm text-muted-foreground",e),...s}));d.displayName="CardDescription";let o=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("p-6 pt-0",e),...s}));o.displayName="CardContent",l.forwardRef(({className:e,...s},a)=>(0,t.jsx)("div",{ref:a,className:(0,r.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter";var m=a(99035);let x=m.fC,u=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)(m.aV,{ref:a,className:(0,r.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));u.displayName=m.aV.displayName;let h=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)(m.xz,{ref:a,className:(0,r.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));h.displayName=m.xz.displayName;let f=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)(m.VY,{ref:a,className:(0,r.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));f.displayName=m.VY.displayName;var p=a(21030),j=a(18558);let g=(0,j.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),N=l.forwardRef(({className:e,variant:s,size:a,asChild:l=!1,...i},n)=>{let c=l?p.g7:"button";return(0,t.jsx)(c,{className:(0,r.cn)(g({variant:s,size:a,className:e})),ref:n,...i})});N.displayName="Button";let y=(0,j.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function v({className:e,variant:s,...a}){return(0,t.jsx)("div",{className:(0,r.cn)(y({variant:s}),e),...a})}var b=a(4805),w=a(7433),C=a(33485);function S({label:e,accept:s,multiple:a,onUpload:n,uploadedFiles:c,description:d}){let[m,x]=(0,l.useState)(!1),u=(0,l.useCallback)(e=>{e.preventDefault(),x(!0)},[]),h=(0,l.useCallback)(e=>{e.preventDefault(),x(!1)},[]),f=(0,l.useCallback)(e=>{e.preventDefault(),x(!1);let t=Array.from(e.dataTransfer.files).filter(e=>s.split(",").map(e=>e.trim()).some(s=>s.startsWith(".")?e.name.toLowerCase().endsWith(s.toLowerCase()):e.type.match(s)));t.length>0&&n(a?t:[t[0]])},[s,a,n]),p=(0,l.useCallback)(e=>{let s=Array.from(e.target.files||[]);s.length>0&&n(a?s:[s[0]])},[a,n]),j=(0,l.useCallback)(e=>{n(c.filter((s,a)=>a!==e))},[c,n]);return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:e}),c.length>0&&(0,t.jsxs)(v,{variant:"secondary",children:[c.length," file",c.length>1?"s":""]})]}),(0,t.jsx)(i,{className:(0,r.cn)("border-2 border-dashed transition-colors cursor-pointer",m?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary/50"),onDragOver:u,onDragLeave:h,onDrop:f,children:(0,t.jsx)(o,{className:"p-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(b.Z,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Drag & drop files here or click to browse"}),(0,t.jsx)("input",{type:"file",accept:s,multiple:a,onChange:p,className:"hidden",id:`file-upload-${e}`}),(0,t.jsx)(N,{variant:"outline",size:"sm",onClick:()=>document.getElementById(`file-upload-${e}`)?.click(),children:"Select Files"}),d&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:d})]})})}),c.length>0&&(0,t.jsx)("div",{className:"space-y-2",children:c.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-muted rounded-lg",children:[(0,t.jsx)(w.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsx)("span",{className:"text-sm flex-1 truncate",children:e.name}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:[(e.size/1024/1024).toFixed(1)," MB"]}),(0,t.jsx)(N,{variant:"ghost",size:"sm",onClick:()=>j(s),className:"h-6 w-6 p-0",children:(0,t.jsx)(C.Z,{className:"h-3 w-3"})})]},s))})]})}var k=a(42228),A=a(77248);let F=l.forwardRef(({className:e,...s},a)=>(0,t.jsx)(k.fC,{ref:a,className:(0,r.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...s,children:(0,t.jsx)(k.z$,{className:(0,r.cn)("flex items-center justify-center text-current"),children:(0,t.jsx)(A.Z,{className:"h-4 w-4"})})}));F.displayName=k.fC.displayName;var z=a(25304);let U=l.forwardRef(({className:e,children:s,...a},l)=>(0,t.jsxs)(z.fC,{ref:l,className:(0,r.cn)("relative overflow-hidden",e),...a,children:[(0,t.jsx)(z.l_,{className:"h-full w-full rounded-[inherit]",children:s}),(0,t.jsx)(T,{}),(0,t.jsx)(z.Ns,{})]}));U.displayName=z.fC.displayName;let T=l.forwardRef(({className:e,orientation:s="vertical",...a},l)=>(0,t.jsx)(z.gb,{ref:l,orientation:s,className:(0,r.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...a,children:(0,t.jsx)(z.q4,{className:"relative flex-1 rounded-full bg-border"})}));T.displayName=z.gb.displayName;var D=a(92358);let R=D.fC,E=D.wy,Z=D.Fw;var O=a(63751),I=a(23572),_=a(64624),$=a(20730),L=a(28576),K=a(4693);function M({title:e,icon:s,options:a,selected:r,onSelectionChange:i}){let[n,c]=(0,l.useState)(!1);if(0===a.length)return null;let d=e=>{i(r.includes(e)?r.filter(s=>s!==e):[...r,e])};return(0,t.jsxs)(R,{open:n,onOpenChange:c,children:[(0,t.jsx)(E,{asChild:!0,children:(0,t.jsxs)(N,{variant:"ghost",className:"w-full justify-between p-3 h-auto",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[s,(0,t.jsx)("span",{className:"font-medium",children:e}),r.length>0&&(0,t.jsx)(v,{variant:"secondary",className:"ml-2",children:r.length})]}),n?(0,t.jsx)(O.Z,{className:"h-4 w-4"}):(0,t.jsx)(I.Z,{className:"h-4 w-4"})]})}),(0,t.jsx)(Z,{className:"space-y-2",children:(0,t.jsxs)("div",{className:"px-3 pb-2",children:[(0,t.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,t.jsx)(N,{variant:"outline",size:"sm",onClick:()=>{i(a)},disabled:r.length===a.length,children:"Select All"}),(0,t.jsx)(N,{variant:"outline",size:"sm",onClick:()=>{i([])},disabled:0===r.length,children:"Clear"})]}),(0,t.jsx)(U,{className:"h-32 border rounded-md p-2",children:(0,t.jsx)("div",{className:"space-y-2",children:a.map(s=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(F,{id:`${e}-${s}`,checked:r.includes(s),onCheckedChange:()=>d(s)}),(0,t.jsx)("label",{htmlFor:`${e}-${s}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:s})]},s))})})]})})]})}function P({filterOptions:e,filters:s,onFilterChange:a}){if(!Object.values(e).some(e=>e.length>0))return(0,t.jsx)(i,{children:(0,t.jsx)(o,{className:"p-4",children:(0,t.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,t.jsx)(_.Z,{className:"h-8 w-8 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm",children:"Upload target users file to enable filtering options"})]})})});let l=Object.values(s).reduce((e,s)=>e+s.length,0);return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Filter Options"}),l>0&&(0,t.jsxs)(N,{variant:"outline",size:"sm",onClick:()=>{a("companies",[]),a("departments",[]),a("locations",[]),a("managers",[])},className:"h-7",children:["Clear All (",l,")"]})]}),(0,t.jsx)(i,{children:(0,t.jsx)(o,{className:"p-0",children:(0,t.jsxs)("div",{className:"divide-y",children:[(0,t.jsx)(M,{title:"Companies",icon:(0,t.jsx)($.Z,{className:"h-4 w-4"}),options:e.companies,selected:s.companies,onSelectionChange:e=>a("companies",e)}),(0,t.jsx)(M,{title:"Departments",icon:(0,t.jsx)(_.Z,{className:"h-4 w-4"}),options:e.departments,selected:s.departments,onSelectionChange:e=>a("departments",e)}),(0,t.jsx)(M,{title:"Locations",icon:(0,t.jsx)(L.Z,{className:"h-4 w-4"}),options:e.locations,selected:s.locations,onSelectionChange:e=>a("locations",e)}),(0,t.jsx)(M,{title:"Managers",icon:(0,t.jsx)(K.Z,{className:"h-4 w-4"}),options:e.managers,selected:s.managers,onSelectionChange:e=>a("managers",e)})]})})})]})}var V=a(25052);let B=l.forwardRef(({className:e,value:s,...a},l)=>(0,t.jsx)(V.fC,{ref:l,className:(0,r.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...a,children:(0,t.jsx)(V.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));B.displayName=V.fC.displayName;var q=a(64670),W=a(48967),J=a(58274),Y=a(26584);function H({end:e,duration:s=1e3,className:a=""}){let[r,i]=(0,l.useState)(0);return(0,l.useEffect)(()=>{let a,t;let l=r=>{a||(a=r);let n=Math.min((r-a)/s,1);i(Math.floor(n*e)),n<1&&(t=requestAnimationFrame(l))};return t=requestAnimationFrame(l),()=>{t&&cancelAnimationFrame(t)}},[e,s]),(0,t.jsx)("span",{className:a,children:r.toLocaleString()})}function G({results:e,sessionId:s}){let{summary:a}=e,l=a.total_users>0?a.top_utilizers/a.total_users*100:0,r=a.total_users>0?a.under_utilized/a.total_users*100:0,d=a.total_users>0?a.for_reallocation/a.total_users*100:0,m=async e=>{try{let a=`/api/download/${e}${s?`?sessionId=${s}`:""}`,t=await fetch(a);if(!t.ok)throw Error("Download failed");let l=await t.blob(),r=window.URL.createObjectURL(l),i=document.createElement("a");i.href=r,i.download="excel"===e?"copilot_analysis.xlsx":"leaderboard.html",document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(r),document.body.removeChild(i)}catch(e){console.error("Download error:",e)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsx)(i,{className:"metric-card",children:(0,t.jsx)(o,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Users"}),(0,t.jsx)("p",{className:"text-2xl font-bold count-up",children:(0,t.jsx)(H,{end:a.total_users})})]}),(0,t.jsx)(_.Z,{className:"h-8 w-8 text-primary"})]})})}),(0,t.jsx)(i,{className:"metric-card",children:(0,t.jsx)(o,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Top Utilizers"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-green-600 count-up",children:(0,t.jsx)(H,{end:a.top_utilizers})}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[l.toFixed(1),"%"]})]}),(0,t.jsx)(q.Z,{className:"h-8 w-8 text-green-600"})]})})}),(0,t.jsx)(i,{className:"metric-card",children:(0,t.jsx)(o,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Under-Utilized"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-yellow-600 count-up",children:(0,t.jsx)(H,{end:a.under_utilized})}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[r.toFixed(1),"%"]})]}),(0,t.jsx)(W.Z,{className:"h-8 w-8 text-yellow-600"})]})})}),(0,t.jsx)(i,{className:"metric-card",children:(0,t.jsx)(o,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"For Reallocation"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-red-600 count-up",children:(0,t.jsx)(H,{end:a.for_reallocation})}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[d.toFixed(1),"%"]})]}),(0,t.jsx)(W.Z,{className:"h-8 w-8 text-red-600"})]})})})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{children:(0,t.jsxs)(c,{className:"flex items-center gap-2",children:[(0,t.jsx)(J.Z,{className:"h-5 w-5"}),"Usage Distribution"]})}),(0,t.jsxs)(o,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(v,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"Top Utilizers"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:[a.top_utilizers," users"]})]}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:[l.toFixed(1),"%"]})]}),(0,t.jsx)(B,{value:l,className:"h-2"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(v,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200",children:"Under-Utilized"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:[a.under_utilized," users"]})]}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:[r.toFixed(1),"%"]})]}),(0,t.jsx)(B,{value:r,className:"h-2"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(v,{variant:"outline",className:"bg-red-50 text-red-700 border-red-200",children:"For Reallocation"}),(0,t.jsxs)("span",{className:"text-sm text-muted-foreground",children:[a.for_reallocation," users"]})]}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:[d.toFixed(1),"%"]})]}),(0,t.jsx)(B,{value:d,className:"h-2"})]})]})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{children:(0,t.jsxs)(c,{className:"flex items-center gap-2",children:[(0,t.jsx)(Y.Z,{className:"h-5 w-5"}),"Download Reports"]})}),(0,t.jsx)(o,{children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsxs)(N,{onClick:()=>m("excel"),className:"flex-1",variant:"outline",children:[(0,t.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),"Download Excel Report"]}),(0,t.jsxs)(N,{onClick:()=>m("html"),className:"flex-1",variant:"outline",children:[(0,t.jsx)(J.Z,{className:"h-4 w-4 mr-2"}),"Download HTML Leaderboard"]})]})})]})]})}var X=a(26771),Q=a(26378),ee=a(1946);let es=[{id:1,label:"Loading data files",icon:X.Z},{id:2,label:"Applying filters",icon:Q.Z},{id:3,label:"Analyzing user patterns",icon:Q.Z},{id:4,label:"Generating reports",icon:X.Z},{id:5,label:"Creating leaderboard",icon:J.Z}];function ea(){let[e,s]=(0,l.useState)(0),[a,r]=(0,l.useState)(0);return(0,l.useEffect)(()=>{let e=setInterval(()=>{r(e=>e>=100?100:e+15*Math.random())},800);return()=>clearInterval(e)},[]),(0,l.useEffect)(()=>{let e=setInterval(()=>{s(e=>e>=es.length-1?es.length-1:e+1)},2e3);return()=>clearInterval(e)},[]),(0,t.jsx)("div",{className:"text-center py-12",children:(0,t.jsxs)("div",{className:"max-w-md mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(ee.Z,{className:"h-12 w-12 animate-spin mx-auto text-primary"}),(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Processing Your Data"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Please wait while we analyze your Copilot usage data"})]}),(0,t.jsx)(i,{children:(0,t.jsx)(o,{className:"p-4",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"Overall Progress"}),(0,t.jsxs)("span",{children:[Math.round(a),"%"]})]}),(0,t.jsx)(B,{value:a,className:"h-2"})]}),(0,t.jsx)("div",{className:"space-y-3",children:es.map((s,a)=>{let l=s.icon,r=a===e,i=a<e;return(0,t.jsxs)("div",{className:`flex items-center gap-3 p-2 rounded-lg transition-colors ${r?"bg-primary/10 text-primary":i?"bg-muted text-muted-foreground":"text-muted-foreground"}`,children:[(0,t.jsx)(l,{className:`h-4 w-4 ${r?"animate-pulse":""}`}),(0,t.jsx)("span",{className:"text-sm",children:s.label}),i&&(0,t.jsx)("div",{className:"ml-auto",children:(0,t.jsx)("div",{className:"h-2 w-2 rounded-full bg-green-500"})}),r&&(0,t.jsx)("div",{className:"ml-auto",children:(0,t.jsx)(ee.Z,{className:"h-3 w-3 animate-spin"})})]},s.id)})})]})})})]})})}let et=l.forwardRef(({className:e,type:s,...a},l)=>(0,t.jsx)("input",{type:s,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:l,...a}));et.displayName="Input";var el=a(66124),er=a(70362),ei=a(77694),en=a(99211),ec=a(81471),ed=a(25076),eo=a(95854),em=a(48803),ex=a(74272),eu=a(89966),eh=a(71639),ef=a(86354),ep=a(57243),ej=a(58238),eg=a(5468),eN=a(96516),ey=a(16014),ev=a(81909),eb=a(59160),ew=a(2760),eC=a(10384);let eS=["#60B5FF","#FF9149","#FF9898","#FF90BB","#FF6363","#80D8C3","#A19AD3","#72BF78"];function ek(e){switch(e){case"Top Utilizer":return"bg-green-100 text-green-800";case"Under-Utilized":return"bg-yellow-100 text-yellow-800";case"For Reallocation":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}function eA(e){switch(e){case"Low":return(0,t.jsx)(el.Z,{className:"h-4 w-4 text-green-600"});case"Medium":return(0,t.jsx)(er.Z,{className:"h-4 w-4 text-yellow-600"});case"High":return(0,t.jsx)(ei.Z,{className:"h-4 w-4 text-red-600"});default:return(0,t.jsx)(er.Z,{className:"h-4 w-4 text-gray-600"})}}function eF({sessionId:e}){let[s,a]=(0,l.useState)([]),[r,m]=(0,l.useState)([]),[p,j]=(0,l.useState)(new Set),[g,y]=(0,l.useState)(""),[b,w]=(0,l.useState)("all"),[C,S]=(0,l.useState)(!1),[k,A]=(0,l.useState)(null),[z,T]=(0,l.useState)("overview"),{toast:D}=(0,eo.pm)();(0,l.useEffect)(()=>{e&&(async()=>{S(!0);try{let s=await fetch(`/api/deep-dive?sessionId=${e}`);if(!s.ok)throw Error("Failed to fetch user data");let t=await s.json();a(t.users||[]),m(t.users||[])}catch(e){console.error("Error fetching users:",e),D({title:"Error",description:"Failed to load user data",variant:"destructive"})}finally{S(!1)}})()},[e,D]),(0,l.useEffect)(()=>{let e=s;g&&(e=e.filter(e=>e.email.toLowerCase().includes(g.toLowerCase()))),"all"!==b&&(e=e.filter(e=>e.classification===b)),m(e)},[s,g,b]),(0,l.useEffect)(()=>{if(p.size>0){Array.from(p);let e=s.filter(e=>p.has(e.email));A({averageEngagement:e.reduce((e,s)=>e+s.engagementScore,0)/e.length,averageConsistency:e.reduce((e,s)=>e+s.consistencyPercent,0)/e.length,totalToolsUsed:new Set(e.flatMap(e=>e.toolsUsed)).size,commonTools:R(e),trendAnalysis:E(e),riskDistribution:Z(e),monthlyComparison:O(e)})}else A(null)},[p,s]);let R=e=>0===e.length?[]:Object.entries(e.reduce((e,s)=>(s.toolsUsed.forEach(s=>{e[s]=(e[s]||0)+1}),e),{})).filter(([s,a])=>a>.5*e.length).map(([e,s])=>({tool:e,count:s})),E=e=>Object.entries(e.reduce((e,s)=>(e[s.trend]=(e[s.trend]||0)+1,e),{})).map(([e,s])=>({trend:e,count:s})),Z=e=>Object.entries(e.reduce((e,s)=>(e[s.riskLevel]=(e[s.riskLevel]||0)+1,e),{})).map(([e,s])=>({risk:e,count:s})),O=e=>["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(s=>{let a=e.map(e=>e.monthlyActivity.find(e=>e.month===s)||{month:s,toolsUsed:0,complexity:0});return{month:s,averageToolsUsed:a.reduce((e,s)=>e+s.toolsUsed,0)/e.length,averageComplexity:a.reduce((e,s)=>e+s.complexity,0)/e.length}}),I=e=>{let s=new Set(p);s.has(e)?s.delete(e):s.add(e),j(s)},$=e=>{switch(e){case"Increasing":return(0,t.jsx)(q.Z,{className:"h-4 w-4 text-green-600"});case"Decreasing":return(0,t.jsx)(W.Z,{className:"h-4 w-4 text-red-600"});case"Stable":return(0,t.jsx)(en.Z,{className:"h-4 w-4 text-yellow-600"});default:return(0,t.jsx)(en.Z,{className:"h-4 w-4 text-gray-600"})}},L=(0,l.useMemo)(()=>Object.entries(s.reduce((e,s)=>(e[s.classification]=(e[s.classification]||0)+1,e),{})).map(([e,a])=>({classification:e,count:a,percentage:a/s.length*100})),[s]),K=(0,l.useMemo)(()=>[{range:"0-0.5",min:0,max:.5},{range:"0.5-1.0",min:.5,max:1},{range:"1.0-1.5",min:1,max:1.5},{range:"1.5-2.0",min:1.5,max:2},{range:"2.0-2.5",min:2,max:2.5},{range:"2.5+",min:2.5,max:10}].map(({range:e,min:a,max:t})=>({range:e,count:s.filter(e=>e.engagementScore>=a&&e.engagementScore<t).length})),[s]);return C?(0,t.jsxs)("div",{className:"flex items-center justify-center h-64",children:[(0,t.jsx)(ec.Z,{className:"h-8 w-8 animate-spin text-primary"}),(0,t.jsx)("span",{className:"ml-2",children:"Loading user data..."})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(i,{children:[(0,t.jsxs)(n,{children:[(0,t.jsxs)(c,{className:"flex items-center gap-2",children:[(0,t.jsx)(ed.Z,{className:"h-5 w-5"}),"User Search & Filter"]}),(0,t.jsx)(d,{children:"Search and filter users to analyze their Copilot usage patterns"})]}),(0,t.jsx)(o,{children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(et,{placeholder:"Search users by email...",value:g,onChange:e=>y(e.target.value),className:"w-full"})}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(N,{variant:"all"===b?"default":"outline",onClick:()=>w("all"),size:"sm",children:["All (",s.length,")"]}),(0,t.jsxs)(N,{variant:"Top Utilizer"===b?"default":"outline",onClick:()=>w("Top Utilizer"),size:"sm",children:["Top (",s.filter(e=>"Top Utilizer"===e.classification).length,")"]}),(0,t.jsxs)(N,{variant:"Under-Utilized"===b?"default":"outline",onClick:()=>w("Under-Utilized"),size:"sm",children:["Under (",s.filter(e=>"Under-Utilized"===e.classification).length,")"]}),(0,t.jsxs)(N,{variant:"For Reallocation"===b?"default":"outline",onClick:()=>w("For Reallocation"),size:"sm",children:["Realloc (",s.filter(e=>"For Reallocation"===e.classification).length,")"]})]})]})})]}),(0,t.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[(0,t.jsxs)(i,{className:"lg:col-span-1",children:[(0,t.jsx)(n,{children:(0,t.jsxs)(c,{className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(_.Z,{className:"h-5 w-5"}),"Users (",r.length,")"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(N,{variant:"outline",size:"sm",onClick:()=>{j(new Set(r.map(e=>e.email)))},disabled:0===r.length,children:"Select All"}),(0,t.jsxs)(N,{variant:"outline",size:"sm",onClick:()=>{j(new Set)},disabled:0===p.size,children:["Clear (",p.size,")"]})]})]})}),(0,t.jsx)(o,{children:(0,t.jsx)(U,{className:"h-[600px]",children:(0,t.jsx)("div",{className:"space-y-2",children:r.map(e=>(0,t.jsx)("div",{className:`p-3 rounded-lg border cursor-pointer transition-colors ${p.has(e.email)?"border-primary bg-primary/5":"border-border hover:bg-muted/50"}`,onClick:()=>I(e.email),children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(F,{checked:p.has(e.email),onChange:()=>I(e.email)}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{className:"font-medium text-sm truncate",children:e.email}),eA(e.riskLevel)]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(v,{variant:"secondary",className:`text-xs ${ek(e.classification)}`,children:e.classification}),$(e.trend)]}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,t.jsxs)("span",{children:["Score: ",e.engagementScore.toFixed(2)]}),(0,t.jsxs)("span",{children:[e.consistencyPercent.toFixed(0),"%"]})]})]})]})},e.email))})})})]}),(0,t.jsxs)(i,{className:"lg:col-span-2",children:[(0,t.jsxs)(n,{children:[(0,t.jsxs)(c,{className:"flex items-center gap-2",children:[(0,t.jsx)(Q.Z,{className:"h-5 w-5"}),"Analysis Dashboard"]}),(0,t.jsx)(d,{children:p.size>0?`Analyzing ${p.size} selected user${p.size>1?"s":""}`:"Select users to view detailed analysis"})]}),(0,t.jsx)(o,{children:(0,t.jsxs)(x,{value:z,onValueChange:T,children:[(0,t.jsxs)(u,{className:"grid w-full grid-cols-4",children:[(0,t.jsx)(h,{value:"overview",children:"Overview"}),(0,t.jsx)(h,{value:"individual",children:"Individual"}),(0,t.jsx)(h,{value:"comparison",children:"Comparison"}),(0,t.jsx)(h,{value:"trends",children:"Trends"})]}),(0,t.jsx)(f,{value:"overview",className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Classification Distribution"})}),(0,t.jsx)(o,{children:(0,t.jsx)(em.h,{width:"100%",height:200,children:(0,t.jsxs)(ex.u,{children:[(0,t.jsx)(eu.b,{data:L,dataKey:"count",nameKey:"classification",cx:"50%",cy:"50%",outerRadius:80,label:({classification:e,percentage:s})=>`${e.split(" ")[0]}: ${s.toFixed(0)}%`,children:L.map((e,s)=>(0,t.jsx)(eh.b,{fill:eS[s%eS.length]},`cell-${s}`))}),(0,t.jsx)(ef.u,{})]})})})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Engagement Score Distribution"})}),(0,t.jsx)(o,{children:(0,t.jsx)(em.h,{width:"100%",height:200,children:(0,t.jsxs)(ep.v,{data:K,children:[(0,t.jsx)(ej.q,{strokeDasharray:"3 3"}),(0,t.jsx)(eg.K,{dataKey:"range",tick:{fontSize:10}}),(0,t.jsx)(eN.B,{tick:{fontSize:10}}),(0,t.jsx)(ef.u,{}),(0,t.jsx)(ey.$,{dataKey:"count",fill:eS[0]})]})})})]})]})}),(0,t.jsx)(f,{value:"individual",className:"space-y-4",children:0===p.size?(0,t.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"Select a user to view detailed individual analysis"}):1===p.size?(0,t.jsx)(ez,{user:s.find(e=>p.has(e.email))}):(0,t.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"Select only one user to view individual analysis"})}),(0,t.jsx)(f,{value:"comparison",className:"space-y-4",children:p.size<2?(0,t.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"Select multiple users to compare their usage patterns"}):(0,t.jsx)(eU,{users:s.filter(e=>p.has(e.email)),comparisonData:k})}),(0,t.jsx)(f,{value:"trends",className:"space-y-4",children:0===p.size?(0,t.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"Select users to view trend analysis"}):(0,t.jsx)(eT,{users:s.filter(e=>p.has(e.email)),comparisonData:k})})]})})]})]})]})}function ez({user:e}){return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)(i,{children:[(0,t.jsxs)(n,{className:"pb-3",children:[(0,t.jsx)(c,{className:"text-lg",children:e.email}),(0,t.jsx)(d,{children:(0,t.jsx)(v,{className:ek(e.classification),children:e.classification})})]}),(0,t.jsxs)(o,{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Engagement Score"}),(0,t.jsx)("span",{className:"font-medium",children:e.engagementScore.toFixed(2)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Consistency"}),(0,t.jsxs)("span",{className:"font-medium",children:[e.consistencyPercent.toFixed(1),"%"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Complexity Score"}),(0,t.jsx)("span",{className:"font-medium",children:e.complexityScore.toFixed(1)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Avg Tools/Report"}),(0,t.jsx)("span",{className:"font-medium",children:e.avgToolsPerReport.toFixed(1)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Report Appearances"}),(0,t.jsx)("span",{className:"font-medium",children:e.appearances})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Risk Level"}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[eA(e.riskLevel),e.riskLevel]})]})]})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Classification Reasoning"})}),(0,t.jsx)(o,{children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Justification:"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.justification})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Tools Used:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:e.toolsUsed.map((e,s)=>(0,t.jsx)(v,{variant:"outline",className:"text-xs",children:e},s))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"First Seen:"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(e.firstAppearance).toLocaleDateString()})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Last Activity:"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(e.lastActivity).toLocaleDateString()})]})]})})]})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Monthly Activity Trend"})}),(0,t.jsx)(o,{children:(0,t.jsx)(em.h,{width:"100%",height:250,children:(0,t.jsxs)(ev.w,{data:e.monthlyActivity,children:[(0,t.jsx)(ej.q,{strokeDasharray:"3 3"}),(0,t.jsx)(eg.K,{dataKey:"month",tick:{fontSize:10}}),(0,t.jsx)(eN.B,{tick:{fontSize:10}}),(0,t.jsx)(ef.u,{}),(0,t.jsx)(eb.x,{type:"monotone",dataKey:"toolsUsed",stroke:eS[0],strokeWidth:2,name:"Tools Used"}),(0,t.jsx)(eb.x,{type:"monotone",dataKey:"complexity",stroke:eS[1],strokeWidth:2,name:"Complexity Score"})]})})})]})]})}function eU({users:e,comparisonData:s}){return s?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Average Metrics"})}),(0,t.jsxs)(o,{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Engagement"}),(0,t.jsx)("span",{className:"font-medium",children:s.averageEngagement.toFixed(2)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Consistency"}),(0,t.jsxs)("span",{className:"font-medium",children:[s.averageConsistency.toFixed(1),"%"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Unique Tools"}),(0,t.jsx)("span",{className:"font-medium",children:s.totalToolsUsed})]})]})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Trend Distribution"})}),(0,t.jsx)(o,{children:(0,t.jsx)(em.h,{width:"100%",height:150,children:(0,t.jsxs)(ex.u,{children:[(0,t.jsx)(eu.b,{data:s.trendAnalysis,dataKey:"count",nameKey:"trend",cx:"50%",cy:"50%",outerRadius:60,label:({trend:e,count:s})=>`${e}: ${s}`,children:s.trendAnalysis.map((e,s)=>(0,t.jsx)(eh.b,{fill:eS[s%eS.length]},`cell-${s}`))}),(0,t.jsx)(ef.u,{})]})})})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Risk Distribution"})}),(0,t.jsx)(o,{children:(0,t.jsx)(em.h,{width:"100%",height:150,children:(0,t.jsxs)(ex.u,{children:[(0,t.jsx)(eu.b,{data:s.riskDistribution,dataKey:"count",nameKey:"risk",cx:"50%",cy:"50%",outerRadius:60,label:({risk:e,count:s})=>`${e}: ${s}`,children:s.riskDistribution.map((e,s)=>(0,t.jsx)(eh.b,{fill:eS[s%eS.length]},`cell-${s}`))}),(0,t.jsx)(ef.u,{})]})})})]})]}),(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Monthly Comparison"})}),(0,t.jsx)(o,{children:(0,t.jsx)(em.h,{width:"100%",height:300,children:(0,t.jsxs)(ew.T,{data:s.monthlyComparison,children:[(0,t.jsx)(ej.q,{strokeDasharray:"3 3"}),(0,t.jsx)(eg.K,{dataKey:"month",tick:{fontSize:10}}),(0,t.jsx)(eN.B,{tick:{fontSize:10}}),(0,t.jsx)(ef.u,{}),(0,t.jsx)(eC.u,{type:"monotone",dataKey:"averageToolsUsed",stackId:"1",stroke:eS[0],fill:eS[0],name:"Avg Tools Used"}),(0,t.jsx)(eC.u,{type:"monotone",dataKey:"averageComplexity",stackId:"1",stroke:eS[1],fill:eS[1],name:"Avg Complexity"})]})})})]})]}):null}function eT({users:e,comparisonData:s}){let a=e.map(e=>({email:e.email.split("@")[0],engagement:e.engagementScore,consistency:e.consistencyPercent,complexity:e.complexityScore}));return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"User Performance Comparison"})}),(0,t.jsx)(o,{children:(0,t.jsx)(em.h,{width:"100%",height:300,children:(0,t.jsxs)(ep.v,{data:a,children:[(0,t.jsx)(ej.q,{strokeDasharray:"3 3"}),(0,t.jsx)(eg.K,{dataKey:"email",tick:{fontSize:10},angle:-45,textAnchor:"end",height:80}),(0,t.jsx)(eN.B,{tick:{fontSize:10}}),(0,t.jsx)(ef.u,{}),(0,t.jsx)(ey.$,{dataKey:"engagement",fill:eS[0],name:"Engagement Score"}),(0,t.jsx)(ey.$,{dataKey:"consistency",fill:eS[1],name:"Consistency %"}),(0,t.jsx)(ey.$,{dataKey:"complexity",fill:eS[2],name:"Complexity Score"})]})})})]}),s?.monthlyComparison&&(0,t.jsxs)(i,{children:[(0,t.jsx)(n,{className:"pb-3",children:(0,t.jsx)(c,{className:"text-lg",children:"Monthly Trend Analysis"})}),(0,t.jsx)(o,{children:(0,t.jsx)(em.h,{width:"100%",height:300,children:(0,t.jsxs)(ev.w,{data:s.monthlyComparison,children:[(0,t.jsx)(ej.q,{strokeDasharray:"3 3"}),(0,t.jsx)(eg.K,{dataKey:"month",tick:{fontSize:10}}),(0,t.jsx)(eN.B,{tick:{fontSize:10}}),(0,t.jsx)(ef.u,{}),(0,t.jsx)(eb.x,{type:"monotone",dataKey:"averageToolsUsed",stroke:eS[0],strokeWidth:3,name:"Avg Tools Used"}),(0,t.jsx)(eb.x,{type:"monotone",dataKey:"averageComplexity",stroke:eS[1],strokeWidth:3,name:"Avg Complexity"})]})})})]})]})}function eD(){let[e,s]=(0,l.useState)("analysis"),[a,r]=(0,l.useState)({targetUsersFile:null,usageReportsFiles:[],filters:{companies:[],departments:[],locations:[],managers:[]},filterOptions:{companies:[],departments:[],locations:[],managers:[]}}),[m,p]=(0,l.useState)({isProcessing:!1,results:null,error:null,sessionId:null}),{toast:j}=(0,eo.pm)();(0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/test-results",{method:"POST"});if(e.ok){let s=await e.json();p(e=>({...e,results:s,sessionId:s.sessionId})),j({title:"Demo data loaded",description:"Sample analysis results loaded for demonstration. Upload your own files to replace with real data."})}}catch(e){console.log("No test results available, starting fresh")}})()},[j]);let g=(0,l.useCallback)(e=>{r(s=>({...s,targetUsersFile:e}));let s=new FileReader;s.onload=e=>{try{let s=(e.target?.result).split("\n"),a=s[0].split(",").map(e=>e.trim().replace(/"/g,"")),t=a.findIndex(e=>e.toLowerCase().includes("company")),l=a.findIndex(e=>e.toLowerCase().includes("department")),i=a.findIndex(e=>e.toLowerCase().includes("city")),n=a.findIndex(e=>e.toLowerCase().includes("manager")),c=new Set,d=new Set,o=new Set,m=new Set;for(let e=1;e<s.length;e++){let a=s[e].split(",").map(e=>e.trim().replace(/"/g,""));-1!==t&&a[t]&&c.add(a[t]),-1!==l&&a[l]&&d.add(a[l]),-1!==i&&a[i]&&o.add(a[i]),-1!==n&&a[n]&&a[n].split("->").forEach(e=>m.add(e.trim()))}r(e=>({...e,filterOptions:{companies:Array.from(c).filter(e=>e).sort(),departments:Array.from(d).filter(e=>e).sort(),locations:Array.from(o).filter(e=>e).sort(),managers:Array.from(m).filter(e=>e).sort()}})),j({title:"Target users file uploaded",description:"Filter options have been populated based on your data."})}catch(e){console.error("Error parsing file:",e),j({title:"Error parsing file",description:"Could not extract filter options from the target users file.",variant:"destructive"})}},s.readAsText(e)},[j]),y=(0,l.useCallback)(e=>{r(s=>({...s,usageReportsFiles:e})),j({title:"Usage reports uploaded",description:`${e.length} file(s) uploaded successfully.`})},[j]),v=(0,l.useCallback)((e,s)=>{r(a=>({...a,filters:{...a.filters,[e]:s}}))},[]),b=(0,l.useCallback)(async()=>{if(0===a.usageReportsFiles.length){j({title:"Missing files",description:"Please upload at least one usage report file.",variant:"destructive"});return}p(e=>({...e,isProcessing:!0,error:null}));try{let e=new FormData;a.targetUsersFile&&e.append("targetUsersFile",a.targetUsersFile),a.usageReportsFiles.forEach((s,a)=>{e.append(`usageReportFile_${a}`,s)}),e.append("filters",JSON.stringify(a.filters));let s=await fetch("/api/analyze",{method:"POST",body:e});if(!s.ok)throw Error(`Analysis failed: ${s.statusText}`);let t=await s.json();if("error"===t.status)throw Error(t.message);p(e=>({...e,isProcessing:!1,results:t,error:null,sessionId:t.sessionId})),j({title:"Analysis completed",description:"Your Copilot usage analysis has been generated successfully."})}catch(e){p(s=>({...s,isProcessing:!1,error:e instanceof Error?e.message:"An unexpected error occurred"})),j({title:"Analysis failed",description:e instanceof Error?e.message:"An unexpected error occurred",variant:"destructive"})}},[a,j]),C=a.usageReportsFiles.length>0&&!m.isProcessing;return(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold text-foreground mb-2",children:"Copilot Usage Analysis"}),(0,t.jsx)("p",{className:"text-xl text-muted-foreground",children:"Analyze Microsoft Copilot adoption patterns and user engagement"})]}),(0,t.jsxs)("div",{className:"grid lg:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,t.jsxs)(i,{children:[(0,t.jsxs)(n,{children:[(0,t.jsxs)(c,{className:"flex items-center gap-2",children:[(0,t.jsx)(w.Z,{className:"h-5 w-5"}),"1. Upload Data"]}),(0,t.jsx)(d,{children:"Upload your target users and usage report files"})]}),(0,t.jsxs)(o,{className:"space-y-4",children:[(0,t.jsx)(S,{label:"Target Users File (Optional)",accept:".csv,.xlsx,.xls",multiple:!1,onUpload:e=>g(e[0]),uploadedFiles:a.targetUsersFile?[a.targetUsersFile]:[],description:"CSV or Excel file containing user information"}),(0,t.jsx)(S,{label:"Usage Reports (Required)",accept:".csv,.xlsx,.xls",multiple:!0,onUpload:y,uploadedFiles:a.usageReportsFiles,description:"One or more CSV or Excel files with usage data"})]})]}),(0,t.jsxs)(i,{children:[(0,t.jsxs)(n,{children:[(0,t.jsxs)(c,{className:"flex items-center gap-2",children:[(0,t.jsx)(_.Z,{className:"h-5 w-5"}),"2. Apply Filters (Optional)"]}),(0,t.jsx)(d,{children:"Filter users by company, department, location, or manager"})]}),(0,t.jsx)(o,{children:(0,t.jsx)(P,{filterOptions:a.filterOptions,filters:a.filters,onFilterChange:v})})]}),(0,t.jsx)(i,{children:(0,t.jsx)(o,{className:"pt-6",children:(0,t.jsxs)(N,{onClick:b,disabled:!C,className:"w-full",size:"lg",children:[(0,t.jsx)(Q.Z,{className:"h-5 w-5 mr-2"}),m.isProcessing?"Analyzing...":"Analyze Data"]})})})]}),(0,t.jsx)("div",{className:"lg:col-span-2",children:(0,t.jsx)(i,{className:"h-full",children:(0,t.jsxs)(o,{className:"p-6",children:[m.isProcessing&&(0,t.jsx)(ea,{}),m.error&&(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsxs)("div",{className:"text-destructive mb-4",children:[(0,t.jsx)(q.Z,{className:"h-12 w-12 mx-auto mb-2"}),(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Analysis Failed"})]}),(0,t.jsx)("p",{className:"text-muted-foreground",children:m.error})]}),!m.isProcessing&&!m.error&&!m.results&&(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsxs)("div",{className:"text-muted-foreground mb-4",children:[(0,t.jsx)(J.Z,{className:"h-12 w-12 mx-auto mb-2"}),(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Ready to Analyze"})]}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Your analysis results will appear here after processing"})]}),m.results&&(0,t.jsxs)(x,{value:e,onValueChange:s,children:[(0,t.jsxs)(u,{className:"grid w-full grid-cols-3",children:[(0,t.jsx)(h,{value:"analysis",children:"Analysis"}),(0,t.jsx)(h,{value:"leaderboard",children:"Leaderboard"}),(0,t.jsx)(h,{value:"deep-dive",children:"Deep Dive"})]}),(0,t.jsx)(f,{value:"analysis",className:"mt-6",children:(0,t.jsx)(G,{results:m.results,sessionId:m.sessionId})}),(0,t.jsx)(f,{value:"leaderboard",className:"mt-6",children:(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(J.Z,{className:"h-12 w-12 mx-auto mb-4 text-primary"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Leaderboard"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-4",children:"View top performing users in the interactive leaderboard"}),(0,t.jsx)(N,{onClick:()=>window.open(`/api/download/leaderboard?sessionId=${m.sessionId}`,"_blank"),variant:"outline",children:"Open Leaderboard"})]})}),(0,t.jsx)(f,{value:"deep-dive",className:"mt-6",children:(0,t.jsx)(eF,{sessionId:m.sessionId})})]})]})})})]})]})}},95854:function(e,s,a){"use strict";a.d(s,{pm:function(){return x}});var t=a(89300);let l=0,r=new Map,i=e=>{if(r.has(e))return;let s=setTimeout(()=>{r.delete(e),o({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,s)},n=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=s;return a?i(a):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},c=[],d={toasts:[]};function o(e){d=n(d,e),c.forEach(e=>{e(d)})}function m({...e}){let s=(l=(l+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>o({type:"DISMISS_TOAST",toastId:s});return o({type:"ADD_TOAST",toast:{...e,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>o({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function x(){let[e,s]=t.useState(d);return t.useEffect(()=>(c.push(s),()=>{let e=c.indexOf(s);e>-1&&c.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>o({type:"DISMISS_TOAST",toastId:e})}}},65522:function(e,s,a){"use strict";a.d(s,{cn:function(){return r}});var t=a(32191),l=a(23607);function r(...e){return(0,l.m6)((0,t.W)(e))}}},function(e){e.O(0,[163,118,386,156,744],function(){return e(e.s=93636)}),_N_E=e.O()}]);